<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="坚持记录，腾空大脑，放飞思想">
<meta property="og:type" content="website">
<meta property="og:title" content="酱汁点滴">
<meta property="og:url" content="http://oneblog.top/page/2/index.html">
<meta property="og:site_name" content="酱汁点滴">
<meta property="og:description" content="坚持记录，腾空大脑，放飞思想">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="酱汁点滴">
<meta name="twitter:description" content="坚持记录，腾空大脑，放飞思想">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://oneblog.top/page/2/"/>





  <title> 酱汁点滴 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">酱汁点滴</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">记录生活工作的点滴进步</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://oneblog.top/2016/06/01/infotech/bigdata/spark和外部数据源/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="刘凡">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="酱汁点滴">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="酱汁点滴" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/01/infotech/bigdata/spark和外部数据源/" itemprop="url">
                  spark和外部数据源
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-06-01T17:18:34+09:00">
                2016-06-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/06/01/infotech/bigdata/spark和外部数据源/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/01/infotech/bigdata/spark和外部数据源/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>As of Spark 1.3, Spark SQL Data sources API is the preferred way to loading data from external data sources. </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://oneblog.top/2016/05/30/infotech/linux/UBuntu/Ubuntu14.04使用root用户登录桌面/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="刘凡">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="酱汁点滴">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="酱汁点滴" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/30/infotech/linux/UBuntu/Ubuntu14.04使用root用户登录桌面/" itemprop="url">
                  Ubuntu14.04使用root用户登录桌面
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-30T17:42:54+09:00">
                2016-05-30
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/05/30/infotech/linux/UBuntu/Ubuntu14.04使用root用户登录桌面/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/30/infotech/linux/UBuntu/Ubuntu14.04使用root用户登录桌面/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Ubuntu14.04桌面版，默认是不能使用root用户登录的。</p>
<p>如果确实需要root用户登录，在启用root账户之后，按照以下内容修改指定文件后，重启即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment"># vi root@ubuntu:~# cat /usr/share/lightdm/lightdm.conf.d/50-ubuntu.conf</span></div><div class="line"></div><div class="line">[SeatDefaults]</div><div class="line">autologin-user=root</div><div class="line">user-session=ubuntu</div><div class="line">greeter-show-manual-login=<span class="literal">true</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://oneblog.top/2016/05/26/infotech/bigdata/ZOOKEEPER精要/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="刘凡">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="酱汁点滴">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="酱汁点滴" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/26/infotech/bigdata/ZOOKEEPER精要/" itemprop="url">
                  Zookeeper精要
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-26T14:34:49+09:00">
                2016-05-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/05/26/infotech/bigdata/ZOOKEEPER精要/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/26/infotech/bigdata/ZOOKEEPER精要/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>Zookeeper 分布式服务框架是 Apache Hadoop 的一个子项目，它主要是用来解决分布式应用中经常遇到的一些数据管理问题，如：统一命名服务、状态同步服务、集群管理、分布式应用配置项的管理等。</p>
<p>Zookeeper 从设计模式角度来看，是一个基于观察者模式设计的分布式服务管理框架，它负责存储和管理大家都关心的数据，然后接受观察者的注册，一旦这些数据的状态发生变化，Zookeeper 就将负责通知已经在 Zookeeper 上注册的那些观察者做出相应的反应，从而实现集群中类似 Master/Slave 管理模式。</p>
<p>Zookeeper 不仅能够帮你维护当前的集群中机器的服务状态，而且能够帮你选出一个“总管”，让这个总管来管理集群，这就是 Zookeeper 的另一个功能 Leader Election。</p>
<p>Zookeeper 作为 Hadoop 项目中的一个子项目，是 Hadoop 集群管理的一个必不可少的模块，它主要用来控制集群中的数据，如它管理 Hadoop 集群中的 NameNode，还有 Hbase 中 Master Election、Server 之间状态同步等。</p>
<h2 id="单机部署"><a href="#单机部署" class="headerlink" title="单机部署"></a>单机部署</h2><p>单机部署很简单，解压后，将conf目录下的zoo_sample.cfg复制成zoo.cfg（使用默认配置即可），运行命令bin/zkServer.sh start即可。</p>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><p><a href="https://www.ibm.com/developerworks/cn/opensource/os-cn-zookeeper/" target="_blank" rel="external">分布式服务框架 Zookeeper</a><br><a href="https://taoistwar.gitbooks.io/spark-operationand-maintenance-management/content/spark_relate_software/zookeeper_install.html" target="_blank" rel="external">ZooKeeper安装配置</a><br><a href="http://coolxing.iteye.com/blog/1871009" target="_blank" rel="external">Zookeeper安装和配置</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://oneblog.top/2016/05/25/infotech/bigdata/KAFKA精要/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="刘凡">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="酱汁点滴">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="酱汁点滴" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/25/infotech/bigdata/KAFKA精要/" itemprop="url">
                  KAFKA精要
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-25T10:15:18+09:00">
                2016-05-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/05/25/infotech/bigdata/KAFKA精要/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/25/infotech/bigdata/KAFKA精要/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Kafka是一种分布式的，基于发布/订阅的消息系统。</p>
<p>单机部署启动，参考<a href="http://kafka.apache.org/documentation.html" target="_blank" rel="external">官方文档</a>的Quick Start即可。在Quick Start中包括了启动（），创建topic，向topic中添加数据，从topic中读取数据（9020端口）等操作。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://oneblog.top/2016/05/25/infotech/bigdata/FLUME精要/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="刘凡">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="酱汁点滴">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="酱汁点滴" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/25/infotech/bigdata/FLUME精要/" itemprop="url">
                  Flume精要
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-25T10:12:07+09:00">
                2016-05-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/05/25/infotech/bigdata/FLUME精要/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/25/infotech/bigdata/FLUME精要/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考文档</p>
<p><a href="http://my.oschina.net/leejun2005/blog/288136" target="_blank" rel="external">Flume NG 简介及配置实战</a> 对于基本概念和入手操作讲解的很好</p>
<p>多参考官方User Guide，大多数配置都有详细说明</p>
<p>client</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># clientMainAgent</span></div><div class="line">clientMainAgent.channels = c1</div><div class="line">clientMainAgent.sources  = s1</div><div class="line">clientMainAgent.sinks    = k1 k2</div><div class="line"></div><div class="line"><span class="comment"># clientMainAgent Spooling Directory Source</span></div><div class="line">clientMainAgent.sources.s1.type = spooldir</div><div class="line">clientMainAgent.sources.s1.spoolDir  = /opt/proxy/nginx/logs</div><div class="line">clientMainAgent.sources.s1.fileHeader = <span class="literal">true</span></div><div class="line">clientMainAgent.sources.s1.deletePolicy = immediate</div><div class="line">clientMainAgent.sources.s1.batchSize = 1000</div><div class="line">clientMainAgent.sources.s1.channels = c1</div><div class="line">clientMainAgent.sources.s1.deserializer.maxLineLength = 1048576</div><div class="line"></div><div class="line"><span class="comment"># clientMainAgent FileChannel</span></div><div class="line">clientMainAgent.channels.c1.type = file</div><div class="line">clientMainAgent.channels.c1.checkpointDir = /var/flume/client/fchannel/spool/checkpoint</div><div class="line">clientMainAgent.channels.c1.dataDirs = /var/flume/client/fchannel/spool/data</div><div class="line">clientMainAgent.channels.c1.capacity = 200000000</div><div class="line">clientMainAgent.channels.c1.keep-alive = 30</div><div class="line">clientMainAgent.channels.c1.write-timeout = 30</div><div class="line">clientMainAgent.channels.c1.checkpoint-timeout = 600</div><div class="line"></div><div class="line"><span class="comment"># clientMainAgent Sinks</span></div><div class="line"><span class="comment"># k1 sink</span></div><div class="line">clientMainAgent.sinks.k1.channel = c1</div><div class="line">clientMainAgent.sinks.k1.type = avro</div><div class="line"><span class="comment"># connect to CollectorMainAgent</span></div><div class="line">clientMainAgent.sinks.k1.hostname = 192.168.79.133</div><div class="line">clientMainAgent.sinks.k1.port = 41415 </div><div class="line"><span class="comment"># k2 sink</span></div><div class="line">clientMainAgent.sinks.k2.channel = c1</div><div class="line">clientMainAgent.sinks.k2.type = avro</div><div class="line"><span class="comment"># connect to CollectorBackupAgentz</span></div><div class="line">clientMainAgent.sinks.k2.hostname = 192.168.79.133</div><div class="line">clientMainAgent.sinks.k2.port = 41416</div><div class="line"></div><div class="line"><span class="comment"># clientMainAgent sinks group</span></div><div class="line">clientMainAgent.sinkgroups = g1</div><div class="line">clientMainAgent.sinkgroups.g1.sinks = k1 k2</div><div class="line"></div><div class="line"><span class="comment"># load_balance type</span></div><div class="line">clientMainAgent.sinkgroups.g1.processor.type = load_balance</div><div class="line">clientMainAgent.sinkgroups.g1.processor.backoff   = <span class="literal">true</span></div><div class="line">clientMainAgent.sinkgroups.g1.processor.selector  = random</div></pre></td></tr></table></figure>
<p>server</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># collectorMainAgent</span></div><div class="line">collectorMainAgent.channels = c2</div><div class="line">collectorMainAgent.sources  = s2</div><div class="line">collectorMainAgent.sinks    =k1 k2</div><div class="line"></div><div class="line"><span class="comment"># collectorMainAgent AvroSource</span></div><div class="line"><span class="comment">#</span></div><div class="line">collectorMainAgent.sources.s2.type = avro</div><div class="line">collectorMainAgent.sources.s2.bind = 192.168.79.133</div><div class="line">collectorMainAgent.sources.s2.port = 41415</div><div class="line">collectorMainAgent.sources.s2.channels = c2</div><div class="line"></div><div class="line"><span class="comment"># collectorMainAgent FileChannel</span></div><div class="line"><span class="comment">#</span></div><div class="line">collectorMainAgent.channels.c2.type = file</div><div class="line">collectorMainAgent.channels.c2.checkpointDir = /var/flume/server01/fchannel/spool/checkpoint</div><div class="line">collectorMainAgent.channels.c2.dataDirs = /var/flume/server01/one/fchannel/spool/data,/var/flume/server01/two/fchannel/spool/data</div><div class="line">collectorMainAgent.channels.c2.capacity = 200000000</div><div class="line">collectorMainAgent.channels.c2.transactionCapacity=6000</div><div class="line">collectorMainAgent.channels.c2.checkpointInterval=60000</div><div class="line"><span class="comment"># collectorMainAgent hdfsSink</span></div><div class="line">collectorMainAgent.sinks.k2.type = hdfs</div><div class="line">collectorMainAgent.sinks.k2.channel = c2</div><div class="line">collectorMainAgent.sinks.k2.hdfs.path = hdfs://192.168.79.133:9000/user/hadoop/flume%&#123;dir&#125;</div><div class="line">collectorMainAgent.sinks.k2.hdfs.filePrefix =k2_%&#123;file&#125;</div><div class="line">collectorMainAgent.sinks.k2.hdfs.inUsePrefix =_</div><div class="line">collectorMainAgent.sinks.k2.hdfs.inUseSuffix =.tmp</div><div class="line">collectorMainAgent.sinks.k2.hdfs.rollSize = 0</div><div class="line">collectorMainAgent.sinks.k2.hdfs.rollCount = 0</div><div class="line">collectorMainAgent.sinks.k2.hdfs.rollInterval = 240</div><div class="line">collectorMainAgent.sinks.k2.hdfs.writeFormat = Text</div><div class="line">collectorMainAgent.sinks.k2.hdfs.fileType = DataStream</div><div class="line">collectorMainAgent.sinks.k2.hdfs.batchSize = 6000</div><div class="line">collectorMainAgent.sinks.k2.hdfs.callTimeout = 60000</div><div class="line">collectorMainAgent.sinks.k1.type = hdfs</div><div class="line">collectorMainAgent.sinks.k1.channel = c2</div><div class="line">collectorMainAgent.sinks.k1.hdfs.path = hdfs://192.168.79.133:9000/user/hadoop/flume%&#123;dir&#125;</div><div class="line">collectorMainAgent.sinks.k1.hdfs.filePrefix =k1_%&#123;file&#125;</div><div class="line">collectorMainAgent.sinks.k1.hdfs.inUsePrefix =_</div><div class="line">collectorMainAgent.sinks.k1.hdfs.inUseSuffix =.tmp</div><div class="line">collectorMainAgent.sinks.k1.hdfs.rollSize = 0</div><div class="line">collectorMainAgent.sinks.k1.hdfs.rollCount = 0</div><div class="line">collectorMainAgent.sinks.k1.hdfs.rollInterval = 240</div><div class="line">collectorMainAgent.sinks.k1.hdfs.writeFormat = Text</div><div class="line">collectorMainAgent.sinks.k1.hdfs.fileType = DataStream</div><div class="line">collectorMainAgent.sinks.k1.hdfs.batchSize = 6000</div><div class="line">collectorMainAgent.sinks.k1.hdfs.callTimeout = 60000</div></pre></td></tr></table></figure>
<p>启动命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 单节点配置</span></div><div class="line">./bin/flume-ng agent --conf ./conf/ --conf-file ./conf/flume-single.conf --name a1 -Dflume.root.logger=INFO,console</div><div class="line"><span class="comment"># 单节点配置（写入HDFS）</span></div><div class="line">./bin/flume-ng agent --conf ./conf/ <span class="_">-f</span> ./conf/flume-writetohdfs.conf -n agent1 -Dflume.root.logger=INFO,console</div><div class="line"><span class="comment"># 客户端配置</span></div><div class="line">./bin/flume-ng agent --conf ./conf/ <span class="_">-f</span> ./conf/flume-client.conf -n clientMainAgent -Dflume.root.logger=DEBUG,console</div><div class="line"><span class="comment"># 服务端配置</span></div><div class="line">./bin/flume-ng agent --conf ./conf/ <span class="_">-f</span> ./conf/flume-server.conf -n collectorMainAgent -Dflume.root.logger=DEBUG,console</div></pre></td></tr></table></figure>
<p>the serializer is a class that converts the Flume Event into an HBase-friendly format.</p>
<p>官方文档<br><a href="https://blogs.apache.org/flume/entry/streaming_data_into_apache_hbase" target="_blank" rel="external">Streaming data into Apache HBase using Apache Flume</a><br>参考文档<br><a href="http://www.aboutyun.com/thread-7912-1-1.html" target="_blank" rel="external">Flume-ng将数据插入hdfs与HBase-0.96.0</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">agent1.sinks.log-sink1.channel = ch1</div><div class="line">agent1.sinks.log-sink1.type = org.apache.flume.sink.hbase.AsyncHBaseSink</div><div class="line">agent1.sinks.log-sink1.table = flume</div><div class="line">agent1.sinks.log-sink1.columnFamily = logs</div><div class="line">agent1.sinks.log-sink1.column = info</div><div class="line">agent1.sinks.log-sink1.serializer = org.apache.flume.sink.hbase.SimpleAsyncHbaseEventSerializer</div></pre></td></tr></table></figure>
<p>遭遇问题</p>
<p>2016-05-26 10:31:57,450 (conf-file-poller-0) [ERROR - org.apache.flume.node.PollingPropertiesFileConfigurationProvider$FileWatcherRunnable.run(PollingPropertiesFileConfigurationProvider.java:145)] Failed to start agent because dependencies were not found in classpath. Error follows.<br>java.lang.NoClassDefFoundError: org/apache/hadoop/hbase/HBaseConfiguration<br>    at org.apache.flume.sink.hbase.AsyncHBaseSink.configure(AsyncHBaseSink.java:393)<br>    at org.apache.flume.conf.Configurables.configure(Configurables.java:41)<br>    at org.apache.flume.node.AbstractConfigurationProvider.loadSinks(AbstractConfigurationProvider.java:413)<br>    at org.apache.flume.node.AbstractConfigurationProvider.getConfiguration(AbstractConfigurationProvider.java:98)<br>    at org.apache.flume.node.PollingPropertiesFileConfigurationProvider$FileWatcherRunnable.run(PollingPropertiesFileConfigurationProvider.java:140)<br>    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)<br>    at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:304)<br>    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:178)<br>    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)<br>    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)<br>    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)<br>    at java.lang.Thread.run(Thread.java:745)</p>
<p>在./conf/flume-env.sh中加入<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">问题参考</div><div class="line">[Flume to HBase dependencie failure](http://stackoverflow.com/questions/28600781/flume-to-hbase-dependencie-failure)</div><div class="line">[Flume agent failed because dependencies were not found in classpath.](https://community.hortonworks.com/questions/22067/flume-agent-failed-because-dependencies-were-not-f.html)</div><div class="line"></div><div class="line"></div><div class="line">如果需要控制如何拆分字段到hbase指定的字段，则需要自行编写serializer代码HbaseEventSerializer类，在apache-flume-1.6.1-src/flume-ng-sinks/flume-ng-hbase-sink/src/main/java中定义自己的类，实现flume中的HbaseEventSerializer接口，需要重新编译来实现。</div><div class="line"></div><div class="line"></div><div class="line">## flume和kafka</div><div class="line"></div><div class="line">在flume 1.6中，才正式集成了flume-kafka插件（https://github.com/thilinamb/flume-ng-kafka-sink）</div></pre></td></tr></table></figure></p>
<h1 id="kafka作为sink的配置"><a href="#kafka作为sink的配置" class="headerlink" title="kafka作为sink的配置"></a>kafka作为sink的配置</h1><p>a1.sinks.k1.type = org.apache.flume.sink.kafka.KafkaSink<br>a1.sinks.k1.topic = mytopic<br>a1.sinks.k1.brokerList = localhost:9092<br>a1.sinks.k1.requiredAcks = 1<br>a1.sinks.k1.batchSize = 20<br>a1.sinks.k1.channel = c1<br>```</p>
<h3 id="CDH相关配置"><a href="#CDH相关配置" class="headerlink" title="CDH相关配置"></a>CDH相关配置</h3><p>参考文档 </p>
<ul>
<li><a href="http://blog.cloudera.com/blog/2014/11/flafka-apache-flume-meets-apache-kafka-for-event-processing/" target="_blank" rel="external">Flafka: Apache Flume Meets Apache Kafka for Event Processing</a></li>
<li><a href="http://www.cloudera.com/documentation/kafka/latest/topics/kafka_flume.html" target="_blank" rel="external">Using Kafka with Flume</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://oneblog.top/2016/05/25/infotech/bigdata/HDFS精要/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="刘凡">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="酱汁点滴">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="酱汁点滴" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/25/infotech/bigdata/HDFS精要/" itemprop="url">
                  HDFS精要
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-25T10:00:55+09:00">
                2016-05-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/05/25/infotech/bigdata/HDFS精要/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/25/infotech/bigdata/HDFS精要/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先用户启动hdfs的守护进程的时候，那个用户就被归属为supergroup，这个supergroup用户当当与root用户，能够删除hdfs上面的所有文件，所以如果你的hdfs上面存储了比如hbase的数据信息，有这么一个超级用户存在，的确是比较危险的。 </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://oneblog.top/2016/05/24/life/中医养生/艾灸/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="刘凡">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="酱汁点滴">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="酱汁点滴" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/24/life/中医养生/艾灸/" itemprop="url">
                  艾灸
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-24T15:42:06+09:00">
                2016-05-24
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/05/24/life/中医养生/艾灸/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/24/life/中医养生/艾灸/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>大人艾灸足三里，可保健脾胃，小儿不可，影响其生长发育。</p>
<p>艾灸治疗糖尿病、高血脂、颈椎病、过敏性鼻炎、扁桃体炎，有良好疗效</p>
<p>艾灸可以提高免疫力，关元穴、中脘穴、足三里、神阙穴（肚脐）</p>
<p>治疗疾病，上午较好，10~11点阳气生发之时，对于大多数上班族，只能是闲时最好，要心安神静，效果才好</p>
<p>南怀瑾肚脐贴（桂圆+花椒+艾绒） 艾灸（艾灸贴） 三伏贴</p>
<p>小儿是否适合以上几种调理方法，足三里是否适合小儿艾灸</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://oneblog.top/2016/05/23/books/scala编程精解/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="刘凡">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="酱汁点滴">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="酱汁点滴" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/23/books/scala编程精解/" itemprop="url">
                  scala编程中文版
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-23T10:27:24+09:00">
                2016-05-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/05/23/books/scala编程精解/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/23/books/scala编程精解/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>scala特点：面向对象、函数式、兼容Java、简洁、高级（代码复杂性）、静态类型</p>
<p>scala解释器</p>
<p>变量定义，scala具有类型推断的能力，即根据输入的value判断变量的类型，但是类型一旦设定就不能改变？所谓静态类型；</p>
<p>val设置的变量一旦初始化则不能再被修改，</p>
<p>以下写法结果相同：<br><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> msg = <span class="string">"Hello world"</span></div><div class="line"><span class="keyword">val</span> msg: String = <span class="string">"Hello world"</span></div><div class="line"><span class="keyword">val</span> msg: java.lang.String = <span class="string">"Hello world"</span></div></pre></td></tr></table></figure></p>
<p>函数定义</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">max</span><span class="params">(<span class="symbol">x:</span> Int, <span class="symbol">y:</span> Int)</span></span>: Int = &#123;</div><div class="line">    <span class="keyword">if</span> (x &gt; y) x <span class="keyword">else</span> y</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">max</span><span class="params">(<span class="symbol">x:</span> Int, <span class="symbol">y:</span> Int)</span></span>: Int = <span class="keyword">if</span> (x &gt; y) x <span class="keyword">else</span> y</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">greeting</span><span class="params">()</span></span> = println(<span class="string">"Hello world"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">greeting</span><span class="params">()</span></span>: Unit = println(<span class="string">"Hello world"</span>)</div></pre></td></tr></table></figure>
<p>scala脚本 args args(0)</p>
<p>函数式编程风格</p>
<figure class="highlight golo"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">args.<span class="keyword">foreach</span>(arg =&gt; <span class="keyword">println</span>(arg))</div><div class="line">args.<span class="keyword">foreach</span>((arg: String) =&gt; <span class="keyword">println</span>(arg))</div><div class="line">args.<span class="keyword">foreach</span>(<span class="keyword">println</span>)</div></pre></td></tr></table></figure>
<p>类型参数化数组</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">val greetStrings = new Array[<span class="string">String</span>](<span class="link">3</span>)</div><div class="line">greetStrings(0) = "Hello"</div></pre></td></tr></table></figure>
<p>greetStrings作为new Array<a href="3">String</a>不能被修改，但是可以给数组元素赋值</p>
<p>Array：元素在物理上连续存储；<br>List：元素在物理上的存储靠链表连接<br>元组：存储不同类型的元素，比如作为函数返回值<br>Set：唯一元素？<br>Map：key-value</p>
<p>函数式编程：没有副作用（println就是副作用之一）或var的函数</p>
<figure class="highlight flix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不推荐</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">printArgs</span></span>(args: Array[String]): Unit = &#123;</div><div class="line">    args.foreach(println)</div><div class="line">&#125;</div><div class="line"><span class="comment">// 推荐</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">formatArgs</span></span>(args: Array[String]) = args.mkString(<span class="string">"\n"</span>)</div><div class="line">println(formatArgs(args))</div></pre></td></tr></table></figure>
<h2 id="类和对象"><a href="#类和对象" class="headerlink" title="类和对象"></a>类和对象</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChecksumAccumulator</span> &#123;</span></div><div class="line">    private var sum = <span class="number">0</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(<span class="symbol">b:</span> Byte)</span></span> &#123; sum += b &#125;</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checksum</span><span class="params">()</span></span>: Int = ~(sum &amp; <span class="number">0xFF</span>) + <span class="number">1</span></div><div class="line">&#125;</div><div class="line"><span class="comment"># 同一文件里，单例对象与某个类共享同一个名称，则其被成为伴生对象</span></div><div class="line"><span class="comment"># 伴生对象主要用于实现静态方法</span></div><div class="line">object ChecksumAccumulator &#123;</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">calculate</span><span class="params">(<span class="symbol">s:</span> String)</span></span>: Int = &#123;</div><div class="line">        ......</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>独立运行的scala程序，必须是object带有main方法，如下</p>
<p>Summer.scala</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">Summer</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]) &#123;</div><div class="line">    println(<span class="string">"object Summer"</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Scala提供了特质scala.Application，可以减少一些输入工作，比如以下代码减少了main函数的定义，但也带来了两个限制，如下：</p>
<ul>
<li>无法访问命令行参数（因为args数组不可访问了）</li>
<li>对于多线程程序需要自行编写main方法</li>
<li>某些JVM的实现没有优化被Application特质执行的对象的初始化代码</li>
</ul>
<p>所以，只有当程序相对简单，并且是单线程情况下，才可以继承Application特质。</p>
<p>ExtendApp.scala</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">ExtendApp</span> <span class="keyword">extends</span> <span class="title">App</span> </span>&#123;</div><div class="line">  println(<span class="string">"object ExtendApp"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://oneblog.top/2016/05/23/books/写给程序员的数据挖掘实践指南/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="刘凡">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="酱汁点滴">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="酱汁点滴" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/23/books/写给程序员的数据挖掘实践指南/" itemprop="url">
                  写给程序员的数据挖掘实践指南
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-23T09:47:30+09:00">
                2016-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/05/23/books/写给程序员的数据挖掘实践指南/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/23/books/写给程序员的数据挖掘实践指南/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="基于物品属性的过滤"><a href="#基于物品属性的过滤" class="headerlink" title="基于物品属性的过滤"></a>基于物品属性的过滤</h2><h3 id="为什么需要"><a href="#为什么需要" class="headerlink" title="为什么需要"></a>为什么需要</h3><p>前两章节中的协同过滤算法，采用了基于用户和基于物品的过滤，使用了用户显式评级或隐式评级的数据，因为必须有用户对物品的评分或者购买记录才有可能纳入计算范围，所以对于全新的物品（没有评级过或购买过），可能永远不会被推荐（推荐系统的“冷启动”问题），为解决这个问题，引入基于物品属性的过滤算法。</p>
<h3 id="算法概述"><a href="#算法概述" class="headerlink" title="算法概述"></a>算法概述</h3><p>由专业人士对物品提取特征集（或称作物品属性或物品基因），然后为每件物品设置特征集中每个特征的权重。</p>
<p>比如，为歌曲设置特征集，包括Country、Jazz、Soul、Rap、Rock五种特征，之后为每首歌曲设置这五个特征的权重，如下：</p>
<table>
<thead>
<tr>
<th>-</th>
<th style="text-align:center">Country</th>
<th style="text-align:center">Jazz</th>
<th style="text-align:right">Soul</th>
<th style="text-align:center">Rap</th>
<th style="text-align:right">Rock</th>
</tr>
</thead>
<tbody>
<tr>
<td>Song1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">3</td>
<td style="text-align:right">4</td>
<td style="text-align:center">2.5</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td>Song2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">2.5</td>
<td style="text-align:right">1.5</td>
<td style="text-align:center">3.5</td>
<td style="text-align:right">1.5</td>
</tr>
<tr>
<td>Song3</td>
<td style="text-align:center">2.5</td>
<td style="text-align:center">1.5</td>
<td style="text-align:right">3.5</td>
<td style="text-align:center">2.5</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td>Song4</td>
<td style="text-align:center">1.5</td>
<td style="text-align:center">0.5</td>
<td style="text-align:right">2</td>
<td style="text-align:center">3</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td>Song5</td>
<td style="text-align:center">4.5</td>
<td style="text-align:center">5</td>
<td style="text-align:right">3.5</td>
<td style="text-align:center">4</td>
<td style="text-align:right">4</td>
</tr>
</tbody>
</table>
<p>要注意特征集的设置，一个不好的特征集，可能会造成计算结果总是偏向某种特性。比如，如果设置了特征是类型type，其中的权重是Country=1、Jazz=2、Soul=3、Rap=4、Rock=5，（而不是设置特征Country=1~5、Jazz=1~5、Soul=1~5、Rap=1~5、Rock=1~5），这样就糟糕了。</p>
<h4 id="分类器"><a href="#分类器" class="headerlink" title="分类器"></a>分类器</h4><p>分类器是一个利用对象属性判定对象属于哪个组或类别的程序！书中提到的分类器用途包括：</p>
<ul>
<li>Twitter情感分类</li>
<li>照片中任务自动识别（脸部特征运用）</li>
<li>定向市场营销（市场分类）</li>
<li>健康及量化自我</li>
<li>判断人们是否恐怖分子</li>
<li>邮件自动分类（垃圾邮件提取）</li>
<li>识别金融诈骗（如信用卡欺诈）</li>
</ul>
<p>这里又提到了分类器算法，用于将歌曲划分到喜欢和不喜欢的组里去，这和K近邻算法有什么不同？</p>
<p>注意其中提到的分类器的用途，值得关注！</p>
<h4 id="归一化"><a href="#归一化" class="headerlink" title="归一化"></a>归一化</h4><p>不使用归一化 vs 归一化一般方法 vs 改进标准分数方法的归一化 ？ （精确率对比）</p>
<h2 id="算法评估"><a href="#算法评估" class="headerlink" title="算法评估"></a>算法评估</h2><h3 id="10折交叉验证"><a href="#10折交叉验证" class="headerlink" title="10折交叉验证"></a>10折交叉验证</h3><p>将数据集随机分成10份，使用其中9份进行训练，使用剩下的1份作为测试集；循环重复10次，使得每次的训练集和测试集都不同，最终求得平均值，作为精确率的结果。</p>
<blockquote>
<p>在机器学习领域，N折交叉验证被成为留一法。留一法可能适用于小数据集。目前为止，10折交叉测试是最流行的选择。</p>
<p>N折交叉验证的具体算法是，数据集有1000个实例时，使用999个实例作为训练集，使用剩下的1个实例作为测试集，循环重复1000次。所谓留一法，就是留下最后一个作为测试集的意思。所以留一法的结果是确定的，不会改变的。但代价是计算时间过长。</p>
<p>在N/M折交叉验证中，如果随机划分的数据有所不同的话，得到的准确率结果也会不同。</p>
</blockquote>
<h3 id="混淆矩阵"><a href="#混淆矩阵" class="headerlink" title="混淆矩阵"></a>混淆矩阵</h3><p>用于计算分类器算法的准确度，比如某个分类器算法，在给出的300个样本中，预测正确了其中的260个，则该算法的准确度是180/300=60%</p>
<h3 id="Kappa统计量"><a href="#Kappa统计量" class="headerlink" title="Kappa统计量"></a>Kappa统计量</h3><p>在得出分类器算法精确度的基础上，根据随机分类器精确度，判断当前分类器的精确程度。比如上例中，算法准确度是60%，那么这60%意味着这个分类器算法到底是好还是不好呢，这就是Kappa统计量的用途。</p>
<p>Kappa统计量，比较的是当前分类器算法和随机分类器算法之间的性能差异。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://oneblog.top/2016/05/17/infotech/bigdata/spark计算模型和工作机制/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="刘凡">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="酱汁点滴">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="酱汁点滴" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/17/infotech/bigdata/spark计算模型和工作机制/" itemprop="url">
                  spark计算模型和工作机制
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-17T17:17:30+09:00">
                2016-05-17
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/05/17/infotech/bigdata/spark计算模型和工作机制/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/17/infotech/bigdata/spark计算模型和工作机制/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Spark站在巨人的肩膀上，依靠Scala强有力的函数式编程、Actor通信模式、闭包、容器、泛型，借助统一资源分配调度框架Mesos，融合了MapReduce和Dryad，最后产生了一个简洁、直观、灵活、高效的大数据分布式处理框架。</p>
<blockquote>
<p>与Hadoop不同，Spark一开始就瞄准性能，将数据（包括部分中间数据）放在内存，在内存中计算。用户将重复利用的数据缓存到内存，提高下次的计算效率，因此Spark尤其适合迭代型和交互型任务。Spark需要大量的内存，但性能可随着机器数目呈多线性增长。</p>
</blockquote>
<p>RDD操作起来与Scala集合类型没有太大差别，这就是Spark追求的目标：像编写单机程序一样编写分布式程序，但它们的数据和运行模型有很大的不同，用户需要具备更强的系统把控能力和分布式系统知识。</p>
<p>用户程序对RDD通过多个函数进行操作，将RDD进行转换。Block-Manager管理RDD的物理分区，每个Block就是节点上对应的一个数据块，可以存储在内存或者磁盘。而RDD中的partition是一个逻辑数据块，对应相应的物理块Block。本质上一个RDD在代码中相当于是数据的一个元数据结构，存储着数据分区及其逻辑结构映射关系，存储着RDD之前的依赖转换关系。</p>
<p>（1）RDD的两种创建方式<br>1）从Hadoop文件系统（或与Hadoop兼容的其他持久化存储系统，如Hive、<br>Cassandra、Hbase）输入（如HDFS）创建。<br>2）从父RDD转换得到新的RDD。<br>（2）RDD的两种操作算子<br>对于RDD可以有两种计算操作算子：Transformation（变换）与Action（行动）。<br>1）Transformation（变换）。<br>Transformation操作是延迟计算的，也就是说从一个RDD转换生成另一个RDD的转换操<br>作不是马上执行，需要等到有Actions操作时，才真正触发运算。<br>2）Action（行动）<br>Action算子会触发Spark提交作业（Job），并将数据输出到Spark系统。<br>（3）RDD的重要内部属性<br>1）分区列表。<br>2）计算每个分片的函数<br>3）对父RDD的依赖列表。<br>4）对Key-Value对数据类型RDD的分区器，控制分区策略和分区数。<br>5）每个数据分区的地址列表（如HDFS上的数据块的地址）。</p>
<p>与DSM相比，RDD模型有两个优势。第一，对于RDD中的批量操作，运行时将根据数据<br>存放的位置来调度任务，从而提高性能。第二，对于扫描类型操作，如果内存不足以缓存整个RDD，就进行部分缓存，将内存容纳不下的分区存储到磁盘上。<br>另外，RDD支持粗粒度和细粒度的读操作。RDD上的很多函数操作（如count和collect等）都是批量读操作，即扫描整个数据集，可以将任务分配到距离数据最近的节点上。同时，RDD也支持细粒度操作，即在哈希或范围分区的RDD上执行关键字查找。</p>
<p>在Transformations算子中再将数据类型维度细分为：Value数据类型和Key-Value对数据类型的Transformations算子。Value型数据的算子封装在RDD类中可以直接使用，Key-<br>Value对数据类型的算子封装于PairRDDFunctions类中，用户需要引入import org.apache.spark.SparkContext._才能够使用。进行这样的细分是由于不同的数据类型处理思想不太一样，同时有些算子是不同的。</p>
<p>在物理上，RDD对象实质上是一个元数据结构，存储着Block、Node等的映射关系，以及其他的元数据信息。一个RDD就是一组分区，在物理数据存储上，RDD的每个分区对应的就是一个Block，Block可以存储在内存，当内存不够时可以存储到磁盘上。</p>
<p>1）输入：在Spark程序运行中，数据从外部数据空间（如分布式存储：textFile读取HDFS等，parallelize方法输入Scala集合或数据）输入Spark，数据进入Spark运行时数据空间，转化为Spark中的数据块，通过BlockManager进行管理。<br>2）运行：在Spark数据输入形成RDD后便可以通过变换算子，如fliter等，对数据进行操<br>作并将RDD转化为新的RDD，通过Action算子，触发Spark提交作业。如果数据需要复用，<br>可以通过Cache算子，将数据缓存到内存。<br>3）输出：程序运行结束数据会输出Spark运行时空间，存储到分布式存储中（如saveAsTextFile输出到HDFS），或Scala数据或集合中（collect输出到Scala集合，count返回Scala int型数据）。</p>
<p>大致可以分为三大类算子。<br>1）Value数据类型的Transformation算子，这种变换并不触发提交作业，针对处理的数<br>据项是Value型的数据。<br>2）Key-Value数据类型的Transfromation算子，这种变换并不触发提交作业，针对处理<br>的数据项是Key-Value型的数据对。<br>3）Action算子，这类算子会触发SparkContext提交Job作业。</p>
<p>spark执行机制总览</p>
<p>Spark应用提交后经历了一系列的转换，最后成为Task在每个节点上执行。Spark应用转<br>换（见图4-1）：RDD的Action算子触发Job的提交，提交到Spark中的Job生成RDD DAG，由<br>DAGScheduler转化为Stage DAG，每个Stage中产生相应的Task集合，TaskScheduler将任<br>务分发到Executor执行。每个任务对应相应的一个数据块，使用用户定义的函数处理数据<br>块。</p>
<p>Spark执行的底层实现原理，如图4-2所示。在Spark的底层实现中，通过RDD进行数据<br>的管理，RDD中有一组分布在不同节点的数据块，当Spark的应用在对这个RDD进行操作<br>时，调度器将包含操作的任务分发到指定的机器上执行，在计算节点通过多线程的方式执行任务。一个操作执行完毕，RDD便转换为另一个RDD，这样，用户的操作依次执行。Spark<br>为了系统的内存不至于快速用完，使用延迟执行的方式执行，即只有操作累计到Action（行动），算子才会触发整个操作序列的执行，中间结果不会单独再重新分配内存，而是在同一个数据块上进行流水线操作。</p>
<p>spark应用概念</p>
<p>Spark应用（Application）是用户提交的应用程序。执行模式有Local、Standalone、YARN、Mesos。根据Spark Application的Driver Program是否在集群中运行，Spark应用的运行方式又可以分为Cluster模式和Client模式。图4-3为Application包含的组件。<br>应用的基本组件如下。<br>·Application：用户自定义的Spark程序，用户提交后，Spark为App分配资源，将程序转换并执行。<br>·Driver Program：运行Application的main（）函数并创建SparkContext。<br>·RDD Graph：RDD是Spark的核心结构，可以通过一系列算子进行操作（主要有Transformation和Action操作）。当RDD遇到Action算子时，将之前的所有算子形成一个有向无环图（DAG），也就是图中的RDD Graph。再在Spark中转化为Job，提交到集群执行。一个App中可以包含多个Job。<br>·Job：一个RDD Graph触发的作业，往往由Spark Action算子触发，在SparkContext中通过runJob方法向Spark提交Job。<br>·Stage：每个Job会根据RDD的宽依赖关系被切分很多Stage，每个Stage中包含一组相同的Task，这一组Task也叫TaskSet。<br>·Task：一个分区对应一个Task，Task执行RDD中对应Stage中包含的算子。Task被封装好后放入Executor的线程池中执行。</p>
<p>应用提交方式</p>
<p>·Driver进程运行在客户端，对应用进行管理监控。<br>·主节点指定某个Worker节点启动Driver，负责整个应用的监控。<br>Driver进程是应用的主控进程，负责应用的解析、切分Stage并调度Task到Executor执<br>行，包含DAGScheduler等重要对象。</p>
<p>spark调度和任务分配</p>
<p>从Spark整体上看，调度可以分为4个级别，Application调度、Job调度、Stage的调度、Task的调度与分发。</p>
<p>spark的I/O机制：序列化、压缩、spark块管理</p>
<p>spark通信模块：RPC RMI JMS EJB WEB-SERVICE（通信框架AKKA）</p>
<p>容错机制 Lineage机制 + checkpoint</p>
<p>此外，如果某个errors分区丢失，则Spark只在相应的lines分区上执行filter操作来重建该errors分区。，RDD的Lineage记录的是粗颗粒度的特定数据Transformation操作（如filter、map、join等）行为。当这个RDD的部分分区数据丢失时，它可以通过Lineage获取足够的信息来重新运算和恢复丢失的数据分区。</p>
<p>检查点（本质是通过将RDD写入Disk做检查点）是为了通过lineage做容错的辅助，lineage过长会造成容错成本过高，这样就不如在中间阶段做检查点容错，如果之后有节点出现问题而丢失分区，从做检查点的RDD开始重做Lineage，就会减少开销。</p>
<p>Shuffle的本义是洗牌、混洗，即把一组有一定规则的数据打散重新组合转换成一组无规则随机数据分区。Spark中的Shuffle更像是洗牌的逆过程，把一组无规则的数据尽量转换成一组具有一定规则的数据，Spark中的Shuffle和MapReduce中的Shuffle思想相同，在实现<br>节和优化方式上不同</p>
<p>为什么Spark计算模型需要Shuffle过程？我们都知道，Spark计算模型是在分布式的环境下计算的，这就不可能在单进程空间中容纳所有的计算数据来进行计算，这样数据就按照Key进行分区，分配成一块一块的小分区，打散分布在集群的各个进程的内存空间中，并不是所有计算算子都满足于按照一种方式分区进行计算。例如，当需要对数据进行排序存储时，就有了重新按照一定的规则对数据重新分区的必要，Shuffle就是包裹在各种需要重分区的算子之下的一个对数据进行重新组合的过程。</p>
<p>主要介绍了Spark的执行机制和调度机制，包括调度与任务分配机制、I/O机制、通信机制、容错机制和Shuffle机制。Spark在执行过程中由Driver控制应用生命周期。调度中，Spark采用了经典的FIFO和FAIR等调度算法对内部的资源实现不同级别的调度。在Spark的I/O中，将数据抽象以块为单位进行管理，RDD中的一个分区就是需要处理的一个块。集群中的通信对于命令和状态的传递极为重要，Spark通过AKKA框架进行集群消息通信。Spark通过Lineage和Checkpoint机制进行容错性保证，Lineage进行重算操作，Checkpoint进行数据冗余备份。最后介绍了Spark中的Shuffle机制，Spark也借鉴了MapReduce模型，但是其Shuffle机制进行了创新与优化。</p>
<p>RDDs support two types of operations: transformations, which create a new dataset from an existing one, and actions, which return a value to the driver program after running a computation on the dataset. For example, map is a transformation that passes each dataset element through a function and returns a new RDD representing the results. On the other hand, reduce is an action that aggregates all the elements of the RDD using some function and returns the final result to the driver program (although there is also a parallel reduceByKey that returns a distributed dataset).</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="刘凡" />
          <p class="site-author-name" itemprop="name">刘凡</p>
          <p class="site-description motion-element" itemprop="description">坚持记录，腾空大脑，放飞思想</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">66</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="" target="_blank" title="知乎专栏">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎专栏
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="" target="_blank" title="豆瓣读书">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  豆瓣读书
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="" target="_blank" title="新浪微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  新浪微博
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">刘凡</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"jiangzhi"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

  


</body>
</html>
